<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mapping ¬∑ Algebra of Graphics</title><meta name="title" content="Mapping ¬∑ Algebra of Graphics"/><meta property="og:title" content="Mapping ¬∑ Algebra of Graphics"/><meta property="twitter:title" content="Mapping ¬∑ Algebra of Graphics"/><meta name="description" content="Documentation for Algebra of Graphics."/><meta property="og:description" content="Documentation for Algebra of Graphics."/><meta property="twitter:description" content="Documentation for Algebra of Graphics."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../democards/bulmagridtheme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Algebra of Graphics logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Algebra of Graphics logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Algebra of Graphics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../generated/penguins/">Tutorial üêß</a></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li></ul></li><li><span class="tocitem">Algebra of Layers</span><ul><li><a class="tocitem" href="../introduction/">Introduction</a></li><li><a class="tocitem" href="../data/">Data</a></li><li class="is-active"><a class="tocitem" href>Mapping</a><ul class="internal"><li><a class="tocitem" href="#Aesthetics"><span>Aesthetics</span></a></li><li><a class="tocitem" href="#Pair-syntax"><span>Pair syntax</span></a></li><li><a class="tocitem" href="#Renaming-columns"><span>Renaming columns</span></a></li><li><a class="tocitem" href="#Transforming-columns"><span>Transforming columns</span></a></li><li><a class="tocitem" href="#Custom-scales"><span>Custom scales</span></a></li></ul></li><li><a class="tocitem" href="../../generated/visual/">Visual</a></li><li><a class="tocitem" href="../../generated/analyses/">Analyses</a></li><li><a class="tocitem" href="../operations/">Algebraic Operations</a></li><li><a class="tocitem" href="../draw/">Drawing Layers</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/types/">Types</a></li><li><a class="tocitem" href="../../API/functions/">Functions</a></li><li><a class="tocitem" href="../../API/recipes/">Recipes</a></li></ul></li><li><a class="tocitem" href="../../FAQs/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../../philosophy/">Philosophy</a></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Algebra of Layers</a></li><li class="is-active"><a href>Mapping</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mapping</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MakieOrg/AlgebraOfGraphics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MakieOrg/AlgebraOfGraphics.jl/blob/master/docs/src/layers/mapping.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Mapping"><a class="docs-heading-anchor" href="#Mapping">Mapping</a><a id="Mapping-1"></a><a class="docs-heading-anchor-permalink" href="#Mapping" title="Permalink"></a></h1><p>Mappings determine how the data is translated into a plot. For example, this <code>mapping</code> maps columns <code>weight</code> and <code>height</code> to positional arguments 1 and 2, and <code>age</code> to the <code>markersize</code> attribute of the <code>Scatter</code> plotting function:</p><pre><code class="nohighlight hljs">mapping(:weight, :height, markersize = :age)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AlgebraOfGraphics.mapping" href="#AlgebraOfGraphics.mapping"><code>AlgebraOfGraphics.mapping</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mapping(positional...; named...)</code></pre><p>Create a <a href="../../API/types/#AlgebraOfGraphics.Layer"><code>Layer</code></a> with <code>positional</code> and <code>named</code> selectors. These selectors will be translated into input data for the Makie plotting function or AlgebraOfGraphics analysis that is chosen to visualize the <code>Layer</code>.</p><p>A <code>Layer</code> created with <code>mapping</code> does not have a data source by default, you can add one by multiplying with the output of the <a href="../data/#AlgebraOfGraphics.data"><code>data</code></a> function.</p><p>The positional and named selectors of <code>mapping</code> are converted to actual input data for the plotting function that will be selected via <code>visual</code>. The translation from selector to data differs according to the <code>data</code> source.</p><p><strong>Tabular data</strong></p><p>When a <code>mapping</code> is combined with a <code>data(tabular)</code> where tabular is some Tables.jl-compatible object, each argument will be interpreted as a column selector. Additionally, it&#39;s allowed to specify columns outside of the dataset directly by wrapping the values in <code>direct</code>. The values can either be vectors that have to match the number of rows from the tabular data, or scalars that will be expanded as if they were a column filled with the same value.</p><pre><code class="language-julia hljs">mapping(
    :x,                        # column named &quot;x&quot;
    &quot;a column&quot;;                # column named &quot;a column&quot;
    color = 1,                 # first column
    marker = direct(&quot;abc&quot;),    # a new column filled with the string &quot;abc&quot;
    linestyle = direct(1:3),   # a new column, length must match the table
)</code></pre><p><strong><code>nothing</code></strong></p><p>If no <code>data</code> is set, each entry of <code>mapping</code> should be an <code>AbstractVector</code> that specifies a column of data directly. Scalars like strings for example will be expanded as if they were a column filled with the same value. This is useful when a legend should be shown, but there&#39;s only one group.</p><pre><code class="language-julia hljs">mapping(
    1:3,               # a column with values 1 to 3
    [4, 5, 6],         # a column with values 4 to 6 
    color = &quot;group 1&quot;, # a column with repeated value &quot;group 1&quot;         
)</code></pre><p><strong>Pregrouped</strong></p><p>With <code>data(Pregrouped()) * mapping(...)</code> or the shortcut <code>pregrouped(...)</code>, each element in <code>mapping</code> specifies input data directly, like with <code>nothing</code>. However, in this mode, data should be passed in pregrouped. Categorical variables should come as a vector of categories, while numerical variables should come as a vector of vectors of values, with as many inner vectors as there are groups in the categorical variables.</p><pre><code class="language-julia hljs">pregrouped(
    [[1, 2, 3], [4, 5]], # two grouped vectors, of length 3 and 2
    color = [&quot;A&quot;, &quot;B&quot;]   # a vector with two categorical group values
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MakieOrg/AlgebraOfGraphics.jl/blob/1b887d5e34ac6252b4a12aa49e02b9f79229d0da/src/algebra/layer.jl#L50-L113">source</a></section></article><h2 id="Aesthetics"><a class="docs-heading-anchor" href="#Aesthetics">Aesthetics</a><a id="Aesthetics-1"></a><a class="docs-heading-anchor-permalink" href="#Aesthetics" title="Permalink"></a></h2><p>The structure of a <code>mapping</code> is always directly tied to the signature of the plotting function (or analysis) that it is being connected with. What visual aspects of the plot the positional or keyword arguments affect depends on the plotting function in use.</p><p>To be used with AlgebraOfGraphics, a plotting function has to add a declaration which aesthetics (like X, Y, Color, MarkerSize, LineStyle) its arguments map to. This mechanism allows AlgebraOfGraphics to correctly convert the raw input data into visual attributes for each plotting function and to correctly create and label axes, colorbars and legends.</p><p>Aesthetics can also change depending on attributes passed to <code>visual</code>.</p><p>For example, for a <code>BarPlot</code>, args 1 and 2 correspond to the X and Y aesthetics by default. But if you change the direction in the <code>visual</code>, then axis labels shift accordingly because the aesthetic mapping has changed to 1 = Y, 2 = X:</p><pre><code class="language-julia hljs">using AlgebraOfGraphics
using CairoMakie

df = (; name = [&quot;Anna&quot;, &quot;Beatrix&quot;, &quot;Claire&quot;], height_meters = [1.55, 1.76, 1.63])
m = mapping(:name, :height_meters)
spec1 = data(df) * m * visual(BarPlot)
spec2 = data(df) * m * visual(BarPlot, direction = :x)

f = Figure()
draw!(f[1, 1], spec1)
draw!(f[1, 2], spec2)
f</code></pre><img src="2b425f53.svg" alt="Example block output"/><h2 id="Pair-syntax"><a class="docs-heading-anchor" href="#Pair-syntax">Pair syntax</a><a id="Pair-syntax-1"></a><a class="docs-heading-anchor-permalink" href="#Pair-syntax" title="Permalink"></a></h2><p>The <code>Pair</code> operator <code>=&gt;</code> can be used for three different purposes within <code>mapping</code>:</p><ul><li>renaming columns</li><li>transforming columns by row</li><li>mapping data to a custom scale</li></ul><h2 id="Renaming-columns"><a class="docs-heading-anchor" href="#Renaming-columns">Renaming columns</a><a id="Renaming-columns-1"></a><a class="docs-heading-anchor-permalink" href="#Renaming-columns" title="Permalink"></a></h2><pre><code class="language-julia hljs">using AlgebraOfGraphics
using CairoMakie

data((; name = [&quot;Anna&quot;, &quot;Beatrix&quot;, &quot;Claire&quot;], height_meters = [1.55, 1.76, 1.63])) *
   mapping(:name =&gt; &quot;Name&quot;, :height_meters =&gt; &quot;Height (m)&quot;) *
   visual(BarPlot) |&gt; draw</code></pre><img src="7571e9ba.svg" alt="Example block output"/><h2 id="Transforming-columns"><a class="docs-heading-anchor" href="#Transforming-columns">Transforming columns</a><a id="Transforming-columns-1"></a><a class="docs-heading-anchor-permalink" href="#Transforming-columns" title="Permalink"></a></h2><p>If a <code>Function</code> is paired to the column selector, it is applied by row to the data. Often, you will want to also assign a new name that fits the transformed data, in which case you can use the three-element <code>column =&gt; transformation =&gt; name</code> syntax:</p><pre><code class="language-julia hljs">using AlgebraOfGraphics
using CairoMakie

data((; name = [&quot;Anna&quot;, &quot;Beatrix&quot;, &quot;Claire&quot;], height_meters = [1.55, 1.76, 1.63])) *
   mapping(:name =&gt; (n -&gt; n[1] * &quot;.&quot;), :height_meters =&gt; (x -&gt; x * 100) =&gt; &quot;Height (cm)&quot;) *
   visual(BarPlot) |&gt; draw</code></pre><img src="cf4abdf8.svg" alt="Example block output"/><h3 id="Row-by-row-versus-whole-column-operations"><a class="docs-heading-anchor" href="#Row-by-row-versus-whole-column-operations">Row-by-row versus whole-column operations</a><a id="Row-by-row-versus-whole-column-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Row-by-row-versus-whole-column-operations" title="Permalink"></a></h3><p>The pair syntax acts <em>row by row</em>, unlike, e.g., <code>DataFrames.transform</code>. This has several advantages.</p><ul><li>Simpler for the user in most cases.</li><li>Less error prone especially<ul><li>with grouped data (should a column operation apply to each group or the whole dataset?)</li><li>when several datasets are used</li></ul></li></ul><p>Naturally, this also incurs some downsides, as whole-column operations, such as z-score standardization, are not supported: they should be done by adding a new column to the underlying dataset beforehand.</p><h3 id="Functions-of-several-arguments"><a class="docs-heading-anchor" href="#Functions-of-several-arguments">Functions of several arguments</a><a id="Functions-of-several-arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-of-several-arguments" title="Permalink"></a></h3><p>In the case of functions of several arguments, such as <code>isequal</code>, the input variables must be passed as a <code>Tuple</code>.</p><pre><code class="language-julia hljs">accuracy = (:species, :predicted_species) =&gt; isequal =&gt; &quot;accuracy&quot;</code></pre><h3 id="Helper-functions"><a class="docs-heading-anchor" href="#Helper-functions">Helper functions</a><a id="Helper-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-functions" title="Permalink"></a></h3><p>Some helper functions are provided, which can be used within the pair syntax to either rename and reorder <em>unique values</em> of a categorical column on the fly or to signal whether a numerical column should be treated as categorical.</p><p>The complete API of helper functions is available at <a href="../../API/functions/#Mapping-helpers">Mapping helpers</a>, but here are a few examples:</p><pre><code class="language-julia hljs"># column `train` has two unique values, `true` and `false`
:train =&gt; renamer([true =&gt; &quot;training&quot;, false =&gt; &quot;testing&quot;]) =&gt; &quot;Dataset&quot;
# column `price` has three unique values, `&quot;low&quot;`, `&quot;medium&quot;`, and `&quot;high&quot;`
:price =&gt; sorter([&quot;low&quot;, &quot;medium&quot;, &quot;high&quot;])
# column `age` is expressed in integers and we want to treat it as categorical
:age =&gt; nonnumeric
# column `labels` is expressed in strings and we do not want to treat it as categorical
:labels =&gt; verbatim
# wrap categorical values to signal that the order from the data source should be respected
:weight =&gt; presorted</code></pre><h2 id="Custom-scales"><a class="docs-heading-anchor" href="#Custom-scales">Custom scales</a><a id="Custom-scales-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-scales" title="Permalink"></a></h2><p>All columns mapped to the same aesthetic type are represented using the same scale by default. This is evident if you plot two different datasets with two different plot types.</p><p>In the following example, both <code>Scatter</code> and <code>HLines</code> use the <code>Color</code> aesthetic, <code>Scatter</code> for the <code>strokecolor</code> keyword and <code>HLines</code> for <code>color</code>. A single merged legend is rendered for both, which does not have a title because it derives from two differently named columns.</p><pre><code class="language-julia hljs">using AlgebraOfGraphics
using CairoMakie

df_a = (; x = 1:9, y = [1, 2, 3, 5, 6, 7, 9, 10, 11], group = repeat([&quot;A&quot;, &quot;B&quot;, &quot;C&quot;], inner = 3))

spec1 = data(df_a) * mapping(:x, :y, strokecolor = :group) * visual(Scatter, color = :transparent, strokewidth = 3, markersize = 15)

df_b = (; y = [4, 8], threshold = [&quot;first&quot;, &quot;second&quot;])

spec2 = data(df_b) * mapping(:y, color = :threshold) * visual(HLines)

draw(spec1 + spec2)</code></pre><img src="1fa6feab.svg" alt="Example block output"/><p>If we want to have separate legends for both, we can assign a custom scale identifier to either the <code>strokecolor</code> or the <code>color</code> mapping. The name can be chosen freely, it serves only to disambiguate.</p><pre><code class="language-julia hljs">spec2_custom_scale = data(df_b) * mapping(:y, color = :threshold =&gt; scale(:color2)) * visual(HLines)

draw(spec1 + spec2_custom_scale)</code></pre><img src="3709afeb.svg" alt="Example block output"/><p>Each scale can be customized further by passing configuration options via <code>scales</code> as the second argument of the <code>draw</code> function. More information on scale options can be found under <a href="../draw/#Scale-options">Scale options</a>.</p><p>As an example, we can pass separate colormaps using the <code>palette</code> keyword:</p><pre><code class="language-julia hljs">spec2_custom_scale = data(df_b) * mapping(:y, color = :threshold =&gt; scale(:color2)) * visual(HLines)

draw(
   spec1 + spec2_custom_scale,
   scales(
      Color = (; palette = [:red, :green, :blue]),
      color2 = (; palette = [:gray30, :gray80]),
   )
)</code></pre><img src="e27b36e6.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../data/">¬´ Data</a><a class="docs-footer-nextpage" href="../../generated/visual/">Visual ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Tuesday 27 August 2024 16:33">Tuesday 27 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
