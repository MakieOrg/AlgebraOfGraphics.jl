<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial 🐧 · Algebra of Graphics</title><meta name="title" content="Tutorial 🐧 · Algebra of Graphics"/><meta property="og:title" content="Tutorial 🐧 · Algebra of Graphics"/><meta property="twitter:title" content="Tutorial 🐧 · Algebra of Graphics"/><meta name="description" content="Documentation for Algebra of Graphics."/><meta property="og:description" content="Documentation for Algebra of Graphics."/><meta property="twitter:description" content="Documentation for Algebra of Graphics."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../democards/bulmagridtheme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Algebra of Graphics logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Algebra of Graphics logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Algebra of Graphics</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li class="is-active"><a class="tocitem" href>Tutorial 🐧</a><ul class="internal"><li><a class="tocitem" href="#Frequency-plots"><span>Frequency plots</span></a></li><li><a class="tocitem" href="#Correlating-two-variables"><span>Correlating two variables</span></a></li><li><a class="tocitem" href="#Smooth-density-plots"><span>Smooth density plots</span></a></li><li><a class="tocitem" href="#Correlating-three-variables"><span>Correlating three variables</span></a></li><li><a class="tocitem" href="#Machine-Learning"><span>Machine Learning</span></a></li></ul></li><li><a class="tocitem" href="../../gallery/">Gallery</a></li></ul></li><li><span class="tocitem">Algebra of Layers</span><ul><li><a class="tocitem" href="../../layers/introduction/">Introduction</a></li><li><a class="tocitem" href="../../layers/data/">Data</a></li><li><a class="tocitem" href="../../layers/mapping/">Mapping</a></li><li><a class="tocitem" href="../visual/">Visual</a></li><li><a class="tocitem" href="../analyses/">Analyses</a></li><li><a class="tocitem" href="../../layers/operations/">Algebraic Operations</a></li><li><a class="tocitem" href="../../layers/draw/">Drawing Layers</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/types/">Types</a></li><li><a class="tocitem" href="../../API/functions/">Functions</a></li><li><a class="tocitem" href="../../API/recipes/">Recipes</a></li></ul></li><li><a class="tocitem" href="../../FAQs/">Frequently Asked Questions</a></li><li><a class="tocitem" href="../../philosophy/">Philosophy</a></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href>Tutorial 🐧</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial 🐧</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MakieOrg/AlgebraOfGraphics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MakieOrg/AlgebraOfGraphics.jl/blob/master/docs/src/generated/penguins.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">Tutorial 🐧</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h1><p>This is a gentle and lighthearted tutorial on how to use tools from AlgebraOfGraphics, using as example dataset a collection of measurements on penguins<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. See the <a href="https://allisonhorst.github.io/palmerpenguins/index.html">Palmer penguins website</a> for more information.</p><p>To follow along this tutorial, you will need to install a few packages. All the required packages can be installed with the following command.</p><pre><code class="language-julia hljs">julia&gt; import Pkg; Pkg.add([&quot;AlgebraOfGraphics&quot;, &quot;CairoMakie&quot;, &quot;DataFrames&quot;, &quot;LIBSVM&quot;, &quot;PalmerPenguins&quot;])</code></pre><p>After the above command completes, we are ready to go.</p><pre><code class="language-julia hljs">using PalmerPenguins, DataFrames

penguins = dropmissing(DataFrame(PalmerPenguins.load()))
first(penguins, 6)</code></pre><div><div style = "float: left;"><span>6×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">species</th><th style = "text-align: left;">island</th><th style = "text-align: left;">bill_length_mm</th><th style = "text-align: left;">bill_depth_mm</th><th style = "text-align: left;">flipper_length_mm</th><th style = "text-align: left;">body_mass_g</th><th style = "text-align: left;">sex</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "InlineStrings.String15" style = "text-align: left;">String15</th><th title = "InlineStrings.String15" style = "text-align: left;">String15</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Adelie</td><td style = "text-align: left;">Torgersen</td><td style = "text-align: right;">39.1</td><td style = "text-align: right;">18.7</td><td style = "text-align: right;">181</td><td style = "text-align: right;">3750</td><td style = "text-align: left;">male</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Adelie</td><td style = "text-align: left;">Torgersen</td><td style = "text-align: right;">39.5</td><td style = "text-align: right;">17.4</td><td style = "text-align: right;">186</td><td style = "text-align: right;">3800</td><td style = "text-align: left;">female</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Adelie</td><td style = "text-align: left;">Torgersen</td><td style = "text-align: right;">40.3</td><td style = "text-align: right;">18.0</td><td style = "text-align: right;">195</td><td style = "text-align: right;">3250</td><td style = "text-align: left;">female</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">Adelie</td><td style = "text-align: left;">Torgersen</td><td style = "text-align: right;">36.7</td><td style = "text-align: right;">19.3</td><td style = "text-align: right;">193</td><td style = "text-align: right;">3450</td><td style = "text-align: left;">female</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">Adelie</td><td style = "text-align: left;">Torgersen</td><td style = "text-align: right;">39.3</td><td style = "text-align: right;">20.6</td><td style = "text-align: right;">190</td><td style = "text-align: right;">3650</td><td style = "text-align: left;">male</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">Adelie</td><td style = "text-align: left;">Torgersen</td><td style = "text-align: right;">38.9</td><td style = "text-align: right;">17.8</td><td style = "text-align: right;">181</td><td style = "text-align: right;">3625</td><td style = "text-align: left;">female</td></tr></tbody></table></div><h2 id="Frequency-plots"><a class="docs-heading-anchor" href="#Frequency-plots">Frequency plots</a><a id="Frequency-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Frequency-plots" title="Permalink"></a></h2><p>Let us start by getting a rough idea of how the data is distributed.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Due to julia&#39;s compilation model, the first plot may take a while to appear.</p></div></div><pre><code class="language-julia hljs">using AlgebraOfGraphics, CairoMakie
set_aog_theme!()

axis = (width = 225, height = 225)
penguin_frequency = data(penguins) * frequency() * mapping(:species)

draw(penguin_frequency; axis = axis)</code></pre><img src="5d8273fd.svg" alt="Example block output"/><h3 id="Small-intermezzo:-saving-the-plot"><a class="docs-heading-anchor" href="#Small-intermezzo:-saving-the-plot">Small intermezzo: saving the plot</a><a id="Small-intermezzo:-saving-the-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Small-intermezzo:-saving-the-plot" title="Permalink"></a></h3><p>If you are working in an interactive enviroment with inline plotting support, such VSCode or Pluto.jl, the above should have displayed a bar plot. If you are working directly in the console, you can simply save the plot and inspect it in the file explorer.</p><pre><code class="language-julia hljs">fg = draw(penguin_frequency; axis = axis)
save(&quot;figure.png&quot;, fg, px_per_unit = 3) # save high-resolution png</code></pre><h3 id="Styling-by-categorical-variables"><a class="docs-heading-anchor" href="#Styling-by-categorical-variables">Styling by categorical variables</a><a id="Styling-by-categorical-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Styling-by-categorical-variables" title="Permalink"></a></h3><p>Next, let us see whether the distribution is the same across islands.</p><pre><code class="language-julia hljs">plt = penguin_frequency * mapping(color = :island)
draw(plt; axis = axis)</code></pre><img src="013cfe3c.svg" alt="Example block output"/><p>Oops! The bars are in the same spot and are hiding each other. We need to specify how we want to fix this. Bars can either <code>dodge</code> each other, or be <code>stack</code>ed on top of each other.</p><pre><code class="language-julia hljs">plt = penguin_frequency * mapping(color = :island, dodge = :island)
draw(plt; axis = axis)</code></pre><img src="29c5afd4.svg" alt="Example block output"/><p>This is our first finding. <code>Adelie</code> is the only species of penguins that can be found on all three islands. To be able to see both which species is more numerous and how different species are distributed across islands in a unique plot, we could have used <code>stack</code>.</p><pre><code class="language-julia hljs">plt = penguin_frequency * mapping(color = :island, stack = :island)
draw(plt; axis = axis)</code></pre><img src="c735afe4.svg" alt="Example block output"/><h2 id="Correlating-two-variables"><a class="docs-heading-anchor" href="#Correlating-two-variables">Correlating two variables</a><a id="Correlating-two-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Correlating-two-variables" title="Permalink"></a></h2><p>Now that we have understood the distribution of these three penguin species, we can start analyzing their features.</p><pre><code class="language-julia hljs">penguin_bill = data(penguins) * mapping(:bill_length_mm, :bill_depth_mm)
draw(penguin_bill; axis = axis)</code></pre><img src="e8251a45.svg" alt="Example block output"/><p>We would actually prefer to visualize these measures in centimeters, and to have cleaner axes labels. As we want this setting to be preserved in all of our <code>bill</code> visualizations, let us save it in the variable <code>penguin_bill</code>, to be reused in subsequent plots.</p><pre><code class="language-julia hljs">penguin_bill = data(penguins) * mapping(
    :bill_length_mm =&gt; (t -&gt; t / 10) =&gt; &quot;bill length (cm)&quot;,
    :bill_depth_mm =&gt; (t -&gt; t / 10) =&gt; &quot;bill depth (cm)&quot;,
)
draw(penguin_bill; axis = axis)</code></pre><img src="0003316b.svg" alt="Example block output"/><p>Much better! Note the parentheses around the function <code>t -&gt; t / 10</code>. They are necessary to specify that the function maps <code>t</code> to <code>t / 10</code>, and not to <code>t / 10 =&gt; &quot;bill length (cm)&quot;</code>.</p><p>There does not seem to be a strong correlation between the two dimensions, which is odd. Maybe dividing the data by species will help.</p><pre><code class="language-julia hljs">plt = penguin_bill * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="2c172a60.svg" alt="Example block output"/><p>Ha! Within each species, penguins with a longer bill also have a deeper bill. We can confirm that with a linear regression</p><pre><code class="language-julia hljs">plt = penguin_bill * linear() * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="864c6c32.svg" alt="Example block output"/><p>This unfortunately no longer shows our data! We can use <code>+</code> to plot both things on top of each other:</p><pre><code class="language-julia hljs">plt = penguin_bill * linear() * mapping(color = :species) + penguin_bill * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="f06f4b1e.svg" alt="Example block output"/><p>Note that the above expression seems a bit redundant, as we wrote the same thing twice. We can &quot;factor it out&quot; as follows</p><pre><code class="language-julia hljs">plt = penguin_bill * (linear() + mapping()) * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="f06f4b1e-001.svg" alt="Example block output"/><p>where <code>mapping()</code> is a neutral multiplicative element. Of course, the above could be refactored as</p><pre><code class="language-julia hljs">layers = linear() + mapping()
plt = penguin_bill * layers * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="f06f4b1e-002.svg" alt="Example block output"/><p>We could actually take advantage of the spare <code>mapping()</code> and use it to pass some extra info to the scatter, while still using all the species members to compute the linear fit.</p><pre><code class="language-julia hljs">layers = linear() + mapping(marker = :sex)
plt = penguin_bill * layers * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="7d1a7817.svg" alt="Example block output"/><p>This plot is getting a little bit crowded. We could instead show female and male penguins in separate subplots.</p><pre><code class="language-julia hljs">layers = linear() + mapping(col = :sex)
plt = penguin_bill * layers * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="aa317f4b.svg" alt="Example block output"/><p>See how both plots show the same fit, because the <code>sex</code> mapping is not applied to <code>linear()</code>. The following on the other hand produces a separate fit for males and females:</p><pre><code class="language-julia hljs">layers = linear() + mapping()
plt = penguin_bill * layers * mapping(color = :species, col = :sex)
draw(plt; axis = axis)</code></pre><img src="0eb9ba7d.svg" alt="Example block output"/><h2 id="Smooth-density-plots"><a class="docs-heading-anchor" href="#Smooth-density-plots">Smooth density plots</a><a id="Smooth-density-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Smooth-density-plots" title="Permalink"></a></h2><p>An alternative approach to understanding how two variables interact is to consider their joint probability density distribution (pdf).</p><pre><code class="language-julia hljs">using AlgebraOfGraphics: density
plt = penguin_bill * density(npoints=50) * mapping(col = :species)
draw(plt; axis = axis)</code></pre><img src="e5ae8d7c.svg" alt="Example block output"/><p>The default colormap is multi-hue, but it is possible to pass single-hue colormaps as well. The color range is inferred from the data by default, but it can also be passed manually. Both settings are passed via <code>scales</code> to <code>draw</code>, because multiple plots can share the same colormap, so <code>visual</code> is not the appropriate place for this setting.</p><pre><code class="language-julia hljs">draw(plt, scales(Color = (; colormap = :grayC, colorrange = (0, 6))); axis = axis)</code></pre><img src="06374d17.svg" alt="Example block output"/><p>A <code>Heatmap</code> (the default visualization for a 2D density) is a bit unfortunate if we want to mark species by color. In that case, one can use <code>visual</code> to change the default visualization and, optionally, fine tune some arguments. In this case, a <code>Wireframe</code> with thin lines looks quite nice. (Note that, for the time being, we must specify explicitly that we require a 3D axis.)</p><pre><code class="language-julia hljs">axis = (type = Axis3, width = 300, height = 300)
layer = density() * visual(Wireframe, linewidth=0.05)
plt = penguin_bill * layer * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="55360697.svg" alt="Example block output"/><p>Of course, a more traditional approach would be to use a <code>Contour</code> plot instead:</p><pre><code class="language-julia hljs">axis = (width = 225, height = 225)
layer = density() * visual(Contour)
plt = penguin_bill * layer * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="67d5b18a.svg" alt="Example block output"/><p>The data and the linear fit can also be added back to the plot:</p><pre><code class="language-julia hljs">layers = density() * visual(Contour) + linear() + mapping()
plt = penguin_bill * layers * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="f853931c.svg" alt="Example block output"/><p>In the case of many layers (contour, density and scatter) it is important to think about balance. In the above plot, the markers are quite heavy and can obscure the linear fit and the contour lines. We can lighten the markers using alpha transparency.</p><pre><code class="language-julia hljs">layers = density() * visual(Contour) + linear() + visual(alpha = 0.5)
plt = penguin_bill * layers * mapping(color = :species)
draw(plt; axis = axis)</code></pre><img src="ce53c236.svg" alt="Example block output"/><h2 id="Correlating-three-variables"><a class="docs-heading-anchor" href="#Correlating-three-variables">Correlating three variables</a><a id="Correlating-three-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Correlating-three-variables" title="Permalink"></a></h2><p>We are now mostly up to speed with <code>bill</code> size, but we have not considered how it relates to other penguin features, such as their weight. For that, a possible approach is to use a continuous color on a gradient to denote weight and different marker shapes to denote species. Here we use <code>group</code> to split the data for the linear regression without adding any additional style.</p><pre><code class="language-julia hljs">body_mass = :body_mass_g =&gt; (t -&gt; t / 1000) =&gt; &quot;body mass (kg)&quot;
layers = linear() * mapping(group = :species) + mapping(color = body_mass, marker = :species)
plt = penguin_bill * layers
draw(plt; axis = axis)</code></pre><img src="a37eb65e.svg" alt="Example block output"/><p>Naturally, within each species, heavier penguins have bigger bills, but perhaps counter-intuitively the species with the shallowest bills features the heaviest penguins. We could also try and see the interplay of these three variables in a 3D plot.</p><pre><code class="language-julia hljs">axis = (type = Axis3, width = 300, height = 300)
plt = penguin_bill * mapping(body_mass, color = :species)
draw(plt; axis = axis)</code></pre><img src="404633a8.svg" alt="Example block output"/><pre><code class="language-julia hljs">plt = penguin_bill * mapping(body_mass, color = :species, layout = :sex)
draw(plt; axis = axis)</code></pre><img src="cd470954.svg" alt="Example block output"/><p>Note that static 3D plot can be misleading, as they only show one projection of 3D data. They are mostly useful when shown interactively.</p><h2 id="Machine-Learning"><a class="docs-heading-anchor" href="#Machine-Learning">Machine Learning</a><a id="Machine-Learning-1"></a><a class="docs-heading-anchor-permalink" href="#Machine-Learning" title="Permalink"></a></h2><p>Finally, let us use Machine Learning techniques to build an automated penguin classifier!</p><p>We would like to investigate whether it is possible to predict the species of a penguin based on its bill size. To do so, we will use a standard classifier technique called <a href="https://en.wikipedia.org/wiki/Support-vector_machine">Support-Vector Machine</a>.</p><p>The strategy is quite simple. We split the data into training and testing subdatasets. We then train our classifier on the training dataset and use it to make predictions on the whole data. We then add the new columns obtained this way to the dataset and visually inspect how well the classifier performed in both training and testing.</p><pre><code class="language-julia hljs">using LIBSVM, Random

# use approximately 80% of penguins for training
Random.seed!(1234) # for reproducibility
N = nrow(penguins)
train = fill(false, N)
perm = randperm(N)
train_idxs = perm[1:floor(Int, 0.8N)]
train[train_idxs] .= true

# fit model on training data and make predictions on the whole dataset
X = hcat(penguins.bill_length_mm, penguins.bill_depth_mm)
y = penguins.species
model = SVC() # Support-Vector Machine Classifier
fit!(model, X[train, :], y[train])
ŷ = predict(model, X)

# incorporate relevant information in the dataset
penguins.train = train
penguins.predicted_species = ŷ</code></pre><p>Now, we have all the columns we need to evaluate how well our classifier performed.</p><pre><code class="language-julia hljs">axis = (width = 225, height = 225)
dataset =:train =&gt; renamer(true =&gt; &quot;training&quot;, false =&gt; &quot;testing&quot;) =&gt; &quot;Dataset&quot;
accuracy = (:species, :predicted_species) =&gt; isequal =&gt; &quot;accuracy&quot;
plt = data(penguins) *
    expectation() *
    mapping(:species, accuracy) *
    mapping(col = dataset)
draw(plt; axis = axis)</code></pre><img src="2a6e85ab.svg" alt="Example block output"/><p>That is a bit hard to read, as all values are very close to <code>1</code>. Let us visualize the error rate instead.</p><pre><code class="language-julia hljs">error_rate = (:species, :predicted_species) =&gt; !isequal =&gt; &quot;error rate&quot;
plt = data(penguins) *
    expectation() *
    mapping(:species, error_rate) *
    mapping(col = dataset)
draw(plt; axis = axis)</code></pre><img src="cd518fa7.svg" alt="Example block output"/><p>So, mostly our classifier is doing quite well, but there are some mistakes, especially among <code>Chinstrap</code> penguins. Using <em>at the same time</em> the <code>species</code> and <code>predicted_species</code> mappings on different attributes, we can see which penguins are problematic.</p><pre><code class="language-julia hljs">prediction = :predicted_species =&gt; &quot;predicted species&quot;
datalayer = mapping(color = prediction, row = :species, col = dataset)
plt = penguin_bill * datalayer
draw(plt; axis = axis)</code></pre><img src="8123000b.svg" alt="Example block output"/><p>Um, some of the penguins are indeed being misclassified... Let us try to understand why by adding an extra layer, which describes the density of the distributions of the three species.</p><pre><code class="language-julia hljs">pdflayer = density() * visual(Contour, colormap=Reverse(:grays)) * mapping(group = :species)
layers = pdflayer + datalayer
plt = penguin_bill * layers
draw(plt; axis = axis)</code></pre><img src="fc9023ea.svg" alt="Example block output"/><p>We can conclude that the classifier is doing a reasonable job: it is mostly making mistakes on outlier penguins.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Gorman KB, Williams TD, Fraser WR (2014) Ecological Sexual Dimorphism and Environmental Variability within a Community of Antarctic Penguins (Genus Pygoscelis). PLoS ONE 9(3): e90081. <a href="https://doi.org/10.1371/journal.pone.0090081">DOI</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../gallery/">Gallery »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Monday 2 September 2024 16:14">Monday 2 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
